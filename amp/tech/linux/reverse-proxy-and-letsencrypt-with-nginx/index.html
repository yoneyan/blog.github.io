<!doctype html><html ⚡><head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>nginxでリバースプロキシとLet's Encryptを導入する - のんびりと生きたい</title><meta name=pinterest content="nopin"><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><link rel="dns-prefetch preconnect" href=https://fonts.gstatic.com crossorigin><link rel="dns-prefetch preconnect" href=https://use.fontawesome.com crossorigin><meta name=theme-color content="#263238"><meta name=generator content="Hugo 0.106.0"><link rel=apple-touch-icon href=https://yoneyan.dev/images/logo.png><link rel=canonical type=text/html href=https://yoneyan.dev/tech/linux/reverse-proxy-and-letsencrypt-with-nginx/ title=のんびりと生きたい><meta name=description content="nginxでLet&rsquo;s Encryptを用いてhttps（SSL/TLS）を有効にする方法をこちらに書いていきます。
当方のLet&rsquo;s Encryptの記事は備忘録と書きます。他社のサイトさんの方がわかりやすいと思うので、わからない点などがあれば調べていただければ幸いです。"><meta property="og:title" content="nginxでリバースプロキシとLet's Encryptを導入する - のんびりと生きたい"><meta property="og:type" content="article"><meta property="og:url" content="https://yoneyan.dev/amp/tech/linux/reverse-proxy-and-letsencrypt-with-nginx/"><meta property="og:image" content="https://yoneyan.dev/images/free_images/ssl_1.webp"><meta property="og:site_name" content="のんびりと生きたい"><meta property="og:description" content="nginxでLet&rsquo;s Encryptを用いてhttps（SSL/TLS）を有効にする方法をこちらに書いていきます。
当方のLet&rsquo;s Encryptの記事は備忘録と書きます。他社のサイトさんの方がわかりやすいと思うので、わからない点などがあれば調べていただければ幸いです。"><meta property="og:locale" content="ja_JP"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="のんびりと生きたい"><meta name=twitter:url content="https://yoneyan.dev/amp/tech/linux/reverse-proxy-and-letsencrypt-with-nginx/"><meta name=twitter:title content="nginxでリバースプロキシとLet's Encryptを導入する - のんびりと生きたい"><meta name=twitter:description content="nginxでLet&rsquo;s Encryptを用いてhttps（SSL/TLS）を有効にする方法をこちらに書いていきます。
当方のLet&rsquo;s Encryptの記事は備忘録と書きます。他社のサイトさんの方がわかりやすいと思うので、わからない点などがあれば調べていただければ幸いです。"><meta name=twitter:image content="https://yoneyan.dev/images/free_images/ssl_1.webp"><script type=application/ld+json>{"@context":"http://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yoneyan.dev\/"},"headline":"nginxでリバースプロキシとLet's Encryptを導入する-のんびりと生きたい","image":{"@type":"ImageObject","url":"https:\/\/yoneyan.dev\/images\/free_images\/ssl_1.webp","height":800,"width":800},"datePublished":"2019-06-04T19:03:13JST","dateModified":"2019-06-04T19:03:13JST","author":{"@type":"Person","name":"のんびりと生きたい"},"publisher":{"@type":"Organization","name":"のんびりと生きたい","logo":{"@type":"ImageObject","url":"https:\/\/yoneyan.dev\/images/logo.png","width":600,"height":60}},"description":"\u003cp\u003enginxでLet\u0026rsquo;s Encryptを用いてhttps（SSL\/TLS）を有効にする方法をこちらに書いていきます。\u003c\/p\u003e\n\u003cp\u003e当方のLet\u0026rsquo;s Encryptの記事は備忘録と書きます。他社のサイトさんの方がわかりやすいと思うので、わからない点などがあれば調べていただければ幸いです。\u003c\/p\u003e"}</script><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><meta name=amp-google-client-id-api content="googleanalytics"><link href="https://fonts.googleapis.com/css?family=Lobster%7cLato:400,700" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css crossorigin=anonymous><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>html{font-size:18px;background-color:rgba(236,239,241,.5)}@media(max-width:768px){html{font-size:15px}}body{color:#333;font-family:roboto slab,ヒラギノ角ゴ pro w3,hiragino kaku gothic pro,メイリオ,Meiryo,sans-serif;font-feature-settings:"palt";font-size:inherit;line-height:1rem;margin:0;padding:0}h1,h2,h3,h4,h5,h6{font-size:1rem;font-weight:700;line-height:1rem;margin:0}hr{border:0;border-top:1px dashed #cfd8dc;margin:1rem 0}p{margin:0;line-height:1rem}a{color:#2196f3;text-decoration:none;transition-duration:.3s}ul,ol{margin:0;padding:0}table{border-collapse:collapse;display:block;overflow-x:auto}th,td{font-size:.8rem;padding:.5rem}tr{border-bottom:1px dashed #ddd}main,aside{display:block}main{padding:1rem 0 3rem}.l-container{position:relative;max-width:68rem;margin:0 auto;padding:0 1rem}.l-container.thin{max-width:44rem}.l-header{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);padding:1rem 0;text-align:center}.l-header .description{margin-top:.5rem;font-size:.8rem}.l-footer{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);font-size:.6rem;font-weight:700;padding:1rem 0}.l-sidebar{margin:-1rem 0}@media(max-width:768px){.l-sidebar{margin-top:4rem}}.mrow{margin:0 -1rem;overflow:hidden}.mcol{box-sizing:border-box;float:left;padding:0 1rem}.c6{width:50%}.c4{width:33.26323833%}.c8{width:66.66666%}@media(max-width:768px){.mcol{width:100%;float:none}}.logo a{font-size:1.4rem;line-height:1.5rem;font-weight:700;color:#333}.articles{margin:-1rem 0;margin-bottom:1rem}.articles.sm{margin:-.5rem 0;margin-bottom:0}article{border-radius:4px;overflow:hidden}article.li{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);height:20rem;overflow:hidden;margin:1rem 0}article.li>a{display:block;color:#333}article.li .inner{padding:1rem}article.li .thumb{height:8rem}article.li .title{color:#333;font-size:1.2rem;line-height:1.5rem;margin-bottom:.5rem}article.li .summary{font-size:.8rem;height:6rem;overflow:hidden;margin-top:1rem}article.li .summary::after{content:'...'}article.lism{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);margin:.5rem 0}article.lism::after{content:'';display:block;clear:both}article.lism>a{display:block;color:#333}article.lism .inner{display:table-cell;vertical-align:middle;height:5rem;padding:0 .75rem}article.lism .thumb{width:5rem;height:5rem;float:left}article.lism .title{font-weight:700;font-size:.8rem;margin-bottom:.25rem}article.sn{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);margin-bottom:1rem}article.sn .thumb{height:20rem}@media(max-width:768px){article.sn .thumb{height:10rem}}article.sn>.article-header,article.sn>.article-body,article.sn .article-footer{padding:2rem}article.sn>.article-body{padding:0 2rem}@media(max-width:768px){article.sn>.article-header,article.sn>.article-body,article.sn .article-footer{padding:1rem}article.sn>.article-body{padding:0 1rem}}article.sn>.article-header .title{font-size:1.8rem;line-height:2rem;margin-bottom:.5rem}@media(max-width:768px){article.sn>.article-header .title{font-size:1.4rem;line-height:1.5rem}}article.sn>.article-header .facts{margin-bottom:1rem}article.sn>.article-body{margin-bottom:1.5rem}article.sn>.article-body h2{border-bottom:.25rem solid #333;font-size:1.2rem;line-height:1.5rem;margin:1.5rem 0;padding:.5rem 0}article.sn>.article-body h3{border-left:.5rem solid #333;line-height:1.5rem;margin:1.5rem 0;padding:.125rem .5rem}article.sn>.article-body ul,article.sn>.article-body ol{margin:1.5rem 0;padding-left:1.5rem}article.sn>.article-body li{padding-bottom:.5rem;line-height:1.5rem}article.sn>.article-body li:last-child{padding-bottom:0}article.sn>.article-body p{margin:1rem 0;line-height:1.5rem}article.sn>.article-body strong,article.sn>.article-body em{font-style:normal;font-weight:700}article.sn>.article-body strong{box-shadow:0 -.5rem #ffc107 inset}article.sn>.article-body em{color:#8bc34a}article.sn>.article-body h2 code{font-size:1.1rem}article.sn>.article-body h1 code,article.sn>.article-body h3 code,article.sn>.article-body h4 code,article.sn>.article-body h5 code,article.sn>.article-body h6 code{font-size:.9rem}article.sn>.article-body code,article.sn>.article-body pre{font-family:Menlo,Consolas,monospace;font-size:.7rem}article.sn>.article-body pre{background-color:#333;color:#fff;line-height:1rem;margin:1.5rem -2rem;overflow:auto}@media(max-width:768px){article.sn>.article-body pre{margin:1.5rem -1rem}}article.sn>.article-body pre>code{display:block;padding:1rem 2rem}@media(max-width:768px){article.sn>.article-body pre>code{padding:1rem}}article.sn>.article-body p code,article.sn>.article-body h1 code,article.sn>.article-body h2 code,article.sn>.article-body h3 code,article.sn>.article-body h4 code,article.sn>.article-body h5 code,article.sn>.article-body h6 code,article.sn>.article-body li code{background-color:#eceff1;color:#333;border-radius:4px;margin:0 .25rem;padding:.375rem;white-space:nowrap}article.sn>.article-body blockquote{position:relative;border-left:.25rem solid #333;font-size:.8rem;padding:.125rem 1rem;margin:1.5rem 0}@media(max-width:768px){article.sn>.article-body blockquote{font-size:1rem}}article.sn>.article-body blockquote p{margin:.5rem 0;line-height:1rem}article.sn>.article-body figure{margin:1.5rem 0}article.sn>.article-body img,article.sn>.article-body figure img,article.sn>.article-body figure amp-img{box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);max-width:100%;height:100%}article.sn>.article-body figcaption{color:#cfd8dc;font-size:.8rem;font-weight:700;margin-top:.5rem}.facts li{display:inline;font-size:.8rem;margin-right:1rem}.facts i{color:#cfd8dc;margin-right:.5em}.facts.sm li{font-size:.7rem}section.sidebar{margin:2rem 0}section.sidebar>header{font-size:.8rem;font-weight:700;letter-spacing:4px;text-align:center;margin:1.5rem 0}section.footer{margin:1rem 0}section.footer>header{font-size:.8rem;margin:.5rem 0}section.footer>header::before{content:"- "}section.footer>header a{font-weight:700;color:#333;text-decoration:underline}.terms{margin:-.25rem}.terms li{display:inline-block}.terms a{display:block;float:left;background-color:#333;border-radius:4px;color:#fff;font-size:.7rem;margin:.25rem;padding:0 .75rem;line-height:1.75rem}.paging{text-align:center;padding:1rem 0}.paging a{display:inline-block;background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);border-radius:4px;color:#333;padding:0 1rem;line-height:3rem}.page-title{text-align:center;margin:1rem 0}.page-title::after{content:'';display:block;border-bottom:.25rem solid #333;width:3rem;margin:1.5rem auto}.page-title>.title{font-size:1.2rem;line-height:1.5rem}.share{padding:0}.share a{display:inline-block;box-shadow:0 0 0 1px rgba(63,63,68,5%),0 1px 3px rgba(63,63,68,.1),0 1px 2px rgba(0,0,0,5%);min-width:1rem;height:2rem;border-radius:4px;color:#333;font-size:.8rem;font-weight:700;line-height:2rem;text-align:center;padding:0 .5rem}.adj article.lism{margin-bottom:1rem}.adj header{font-weight:700;font-size:.8rem}.toc{padding:0 2rem;margin:1rem 0}.toc nav>ul{background-color:#eceff1;border-radius:4px;display:inline-block;font-size:.8rem;padding:.5rem 1rem;word-break:break-all;list-style:none}.toc ul{padding:0}.toc ul ul{padding-left:1rem}.toc ul ul>li{font-weight:700;margin:.5rem 0;list-style-type:decimal}.toc ul ul ul{padding-left:1rem}.toc ul ul ul>li{list-style-type:disc;font-weight:500}.toc li{color:#90a4ae}@media(max-width:768px){.toc{padding:0 1rem}}.thumb{background-image:url(https://yoneyan.dev/images/default.jpg);background-size:cover;background-position:50%}.thumb-74a76d64c58d7e3b7fe12c3890d21182{background-image:url(https://yoneyan.dev/images/server/hardware/network/solarflare_sfn7002f.webp)}.thumb-4781b54f08fbb9d8881fe67d584cfa01{background-image:url(https://yoneyan.dev/images/server/hardware/network/Network.webp)}.thumb-ec2545bc76955bcb3d5e2f63c05cd571{background-image:url(https://yoneyan.dev/images/server/hardware/network/Network.webp)}.thumb-adc879114b814c9e7d7b61580b9f212d{background-image:url(https://yoneyan.dev/images/server/home/2019/12/router.webp)}.thumb-2570fc7b86f3160a0d9a92022c993b86{background-image:url(https://yoneyan.dev/images/server/home/2019/12/router.webp)}.thumb-d3ab14dcf5c560ab61a6d10f7bfbcc15{background-image:url(https://yoneyan.dev/images/myself/pocketbell/character.webp)}.thumb-6764b54b0d1661845590622ae858e36f{background-image:url(https://yoneyan.dev/images/server/home/2019/09/ipphone.webp)}.thumb-a22089782467ad0ea8e69c86618215c7{background-image:url(https://yoneyan.dev/images/server/home/2019/09/serverroom.webp)}.thumb-e411741d2a73dee3f61df88799a4631f{background-image:url(https://yoneyan.dev/images/server/home/2019/09/homeserver.webp)}.thumb-1036ea40acc9defe4ca8cb5942b1338a{background-image:url(https://yoneyan.dev/images/server/home/2019/08/serverroomhub2.webp)}.thumb-916edecca850b12fba216de530733a13{background-image:url(https://yoneyan.dev/images/free_images/network_1.webp)}.thumb-fdd05a1c4346a07d8fa7b0e298d70658{background-image:url(https://yoneyan.dev/images/free_images/warning_1.webp)}.thumb-b3a22ab46469c6b53a9e446f8893da65{background-image:url(https://yoneyan.dev/images/free_images/network_1.webp)}.thumb-6eae0e041365dd4aa516cf859d125983{background-image:url(https://yoneyan.dev/images/server/home/2019/09/switch.webp)}.thumb-2638817b73aca2e24a46802767d6a172{background-image:url(https://yoneyan.dev/images/server/home/2019/09/UPS.webp)}.thumb-30451a92d29cd94fa41bec431974da4b{background-image:url(https://yoneyan.dev/images/free_images/network_1.webp)}.thumb-f271f3d95f8819879e79a9a80744cb7a{background-image:url(https://yoneyan.dev/images/review/gpdmicro/1.webp)}.thumb-660a46d92f5fcd02e63669b9bd53c010{background-image:url(https://yoneyan.dev/images/free_images/sim_1.webp)}.thumb-f58f4a2852ee4e7b2f9227ca1d797b82{background-image:url(https://yoneyan.dev/images/myself/broken_x230/edge.webp)}.thumb-bbf4d504dc1e4144398b93f8b42b4b72{background-image:url(https://yoneyan.dev/images/free_images/ssl_1.webp)}.thumb-0b483f78ca2c76cc512f8e7ab162aa07{background-image:url(https://yoneyan.dev/images/free_images/hdd_1.webp)}.thumb-f7f2d8b18a7cce7556d58049be7e0fa4{background-image:url(https://yoneyan.dev/images/free_images/hdd_1.webp)}.thumb-f8a5819ad48c1b896cedb13eb624044b{background-image:url(https://yoneyan.dev/images/free_images/hdd_1.webp)}.thumb-ba1bc817f2d35666ea4f05390e5d5870{background-image:url(https://yoneyan.dev/images/free_images/vpn_1.webp)}.thumb-9d2b57991a727244d1d9b2ef2037894e{background-image:url(https://yoneyan.dev/images/server/home/2019/09/FCSwitch.webp)}.thumb-6a7e2d7d76faaa22c06319a033c950c2{background-image:url(https://yoneyan.dev/images/server/home/2019/09/switch.webp)}.thumb-8b78b2e65fabbb4d5ef507d12569c90b{background-image:url(https://yoneyan.dev/images/free_images/hdd_1.webp)}.thumb-fe2c982027c9e585452d827d24483577{background-image:url(https://yoneyan.dev/images/free_images/tv_1.webp)}.thumb-1eb3dec72706405073b2565c53c9acce{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-6c676cd8c95335471384219019315626{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-64e236012b6c2bc1f44390680f68ff73{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-38d2d350bebf97dbed9005128fb5b2d4{background-image:url(https://yoneyan.dev/images/free_images/stop_1.webp)}.thumb-7a9f1990d0a1af4fdf3d13f7e893a90f{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-4560238079c425f942285d5531974fd2{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-65d38bee1ba2c6562ad51d6d5e1ecea9{background-image:url(https://yoneyan.dev/images/free_images/wordpress.webp)}.thumb-550933345343f11a429e4006300cf9d4{background-image:url(https://yoneyan.dev/images/server/home/2019/08/serverroomhub2.webp)}.thumb-af5b23261db9908c16c5f7706d420639{background-image:url(https://yoneyan.dev/images/free_images/vpn_1.webp)}.thumb-6fc2e0f23436a18ca09775a9d3341370{background-image:url(https://yoneyan.dev/images/free_images/vpn_1.webp)}.thumb-0a76138d7c80ce02f147615eaa037672{background-image:url(https://yoneyan.dev/images/free_images/north-korea.webp)}.thumb-07b1b06a4b1b9cae8cd65053253e33ea{background-image:url(https://yoneyan.dev/images/server/home/2019/09/night.webp)}.thumb-865846cd5fa7303f4ead2a402e54c4e9{background-image:url(https://yoneyan.dev/images/free_images/vm.webp)}.thumb-194eea0562358a1e48a8958756097a29{background-image:url(https://yoneyan.dev/images/free_images/vm.webp)}.thumb-c4287d52e81f80a07598bcd05c114495{background-image:url(https://yoneyan.dev/images/server/home/2019/09/homeAP.webp)}.thumb-a2339e7a1c8e6175e142fde3b34249f1{background-image:url(https://yoneyan.dev/images/server/home/2018/06/network.webp)}.thumb-432977ab9bb178b0486fba1c058d38ad{background-image:url(https://yoneyan.dev/images/free_images/hdd_1.webp)}.thumb-4643ef422b20e2d63e1ea8f1ef41075e{background-image:url(https://yoneyan.dev/images/server/home/2018/06/network.webp)}.thumb-b1fb8c9850d20d4c2cd9d74af3748e34{background-image:url(https://yoneyan.dev/images/app/server/nmtui/nmtui-interface.webp)}.thumb-2f17ffd0a8d0dde7072ce7038b13d411{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-996ff53622132be072dd8dc011e67843{background-image:url(https://yoneyan.dev/images/server/hardware/brade/blade8.webp)}.thumb-d357de1e6136382a9558bb48533d1858{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-8f11a8ad0ed46e9c41881558ef87b657{background-image:url(https://yoneyan.dev/images/free_images/cloud_1.webp)}.thumb-58d742b1e9ee5a7ffbe7ff632f4ce935{background-image:url(https://yoneyan.dev/images/fix/silent/RX300_S6/server_after.webp)}.thumb-af83fc5ce750528704206eec412e5f2f{background-image:url(https://yoneyan.dev/images/free_images/phone.webp)}.thumb-f3e45846c546313f302584fb297dc0f1{background-image:url(https://yoneyan.dev/images/free_images/vpn_1.webp)}.thumb-81320880c2c7a59ae2cfcb8706569950{background-image:url(https://yoneyan.dev/images/free_images/graph_1.webp)}.thumb-a208313201b40374d9a1e87dfcafb06c{background-image:url(https://yoneyan.dev/images/free_images/wifi_1.webp)}.thumb-62bee97513c5cb913259bec2c2875419{background-image:url(https://yoneyan.dev/images/free_images/wifi_1.webp)}.thumb-349ac03be4e99642cad3438a3adabb22{background-image:url(https://yoneyan.dev/images/free_images/cloud_1.webp)}.thumb-45de6147a8df2f94a90949cf38df2b17{background-image:url(https://yoneyan.dev/images/free_images/vpn_1.webp)}.thumb-0f269c02026f089d1407d8ef6d3ca2e8{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-cc6f4a2cc336889f6324e38db0a68403{background-image:url(https://yoneyan.dev/images/free_images/remote-game.webp)}.thumb-309f89c436cb0a3ae6f1f610fcdc275b{background-image:url(https://yoneyan.dev/images/free_images/remote-game.webp)}.thumb-82e4bf5bb051f05faa1891b011180571{background-image:url(https://yoneyan.dev/images/free_images/pc_1.webp)}.thumb-70411986bdc97ec0a495408e3299c97d{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-0eead276efde547d06d6b09c600d5714{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-c2265448be0ce789b2d0a01f25dba69d{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-c5b95fc36ca33c0bca6d278763f54556{background-image:url(https://yoneyan.dev/images/free_images/pc_1.webp)}.thumb-e89d5cd697d14301cdaa0f8943c71b11{background-image:url(https://yoneyan.dev/images/free_images/app_2.webp)}.thumb-bb9f297100005958c6cdac8366049e29{background-image:url(https://yoneyan.dev/images/free_images/network_1.webp)}.thumb-ad5ba0746c39942b46dd5378d4f105df{background-image:url(https://yoneyan.dev/images/free_images/windows.webp)}.thumb-b17560b307612ea6dccb6f2340383fa9{background-image:url(https://yoneyan.dev/images/free_images/game_1.webp)}.thumb-8dd892d57a08ce11f673f41294785d94{background-image:url(https://yoneyan.dev/images/review/p10_lite/p10_lite.webp)}.thumb-cf46fe1528e5d18c21bfa40b0b71ec13{background-image:url(https://yoneyan.dev/images/game/hard/PS3-2.webp)}.thumb-f3e8c8046d42c09de78b25dbb7c3a9d4{background-image:url(https://yoneyan.dev/images/free_images/mail_1.webp)}.thumb-057d99cae28834e2b02625677741a514{background-image:url(https://yoneyan.dev/images/myself/karaoke/ps4/play.webp)}.thumb-5f7c627da8499eb33a5c0cecffcee920{background-image:url(https://yoneyan.dev/images/free_images/router_1.webp)}.thumb-fd4a0253bd77cb280ae9aaf302b73dc1{background-image:url(https://yoneyan.dev/images/game/hard/ps4pro.webp)}.thumb-b9ac7cf425e63211d1f68a3b9e1e44b6{background-image:url(https://yoneyan.dev/images/free_images/usb_cable.webp)}.thumb-aefc68084d3da56feacfc01661b924c4{background-image:url(https://yoneyan.dev/images/free_images/washhouse.webp)}.thumb-fa908946545dbd4c9fffaced048b0f5f{background-image:url(https://yoneyan.dev/images/free_images/monitor.webp)}.thumb-690f29dae720b535e84b0969b15ddf19{background-image:url(https://yoneyan.dev/images/free_images/windows.webp)}.thumb-e186f67021a6475867f386c1673f5500{background-image:url(https://yoneyan.dev/images/free_images/music_1.webp)}.thumb-204b515bb46611ed78b48e609e708cfd{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-df0674c62aafc0dae14f4f4140489b31{background-image:url(https://yoneyan.dev/images/free_images/game_1.webp)}.thumb-f0b1b4e33216c3760403da7204d686d8{background-image:url(https://yoneyan.dev/images/free_images/security_1.webp)}.thumb-8e0a4d11cd449d638742df408c6348a0{background-image:url(https://yoneyan.dev/images/free_images/app_1.webp)}.thumb-6550efa4300a79620d7155bfdfcc29a9{background-image:url(https://yoneyan.dev/images/free_images/disk.webp)}.thumb-d7e5d0ff0467f50fa366adea2eb2de1f{background-image:url(https://yoneyan.dev/images/free_images/pc_1.webp)}.thumb-73b02e709c58711bf2b24b53b2d717f6{background-image:url(https://yoneyan.dev/images/free_images/server_1.webp)}.thumb-5011a742839c28e921fdca002a060f36{background-image:url(https://yoneyan.dev/images/free_images/sim_1.webp)}.thumb-5d24c867970239150a5099644481a4ba{background-image:url(https://yoneyan.dev/images/free_images/sim_1.webp)}.thumb-e78be4c01d78f06e60605ab06f4b82e0{background-image:url(https://yoneyan.dev/images/free_images/software_1.webp)}.thumb-ce728d203c8be12d33d4b35a810a3ac8{background-image:url(https://yoneyan.dev/images/free_images/wordpress.webp)}.thumb-2bbae0e01d7ceddc06d53842bdd02c8f{background-image:url(https://yoneyan.dev/images/free_images/software_1.webp)}.thumb-2181d2664fc134768a3e90bf909036b7{background-image:url(https://yoneyan.dev/images/technology/zenfone2laser_cm/start.webp)}.thumb-2a552d0c1de826a64c172c09f8dd4968{background-image:url(https://yoneyan.dev/images/free_images/service.webp)}.thumb-830a8cac91c31e2cea9129074837f25d{background-image:url(https://yoneyan.dev/images/free_images/sega_saturn.webp)}.thumb-5944ae54ee0f010112938babcb9a6e03{background-image:url(https://yoneyan.dev/images/game/hard/sidewinder/sidewinder-precision-pro.webp)}.thumb-56ea1bf1b9854d4ae1c67c27497472bd{background-image:url(https://yoneyan.dev/images/free_images/mic.webp)}.thumb-4cd0ba4cc1cc7beaa3c94149c9a62634{background-image:url(https://yoneyan.dev/images/technology/zenfone2laser_cm/start.webp)}.thumb-4fb065600662f7487233e092e570ec35{background-image:url(https://yoneyan.dev/images/game/hard/kinect/kinect_1.webp)}.thumb-8d94f5690066884137393237ebb372db{background-image:url(https://yoneyan.dev/images/game/hard/kinect/kinect_1.webp)}.thumb-6f6dcedcd9b9f58165fb49427007421e{background-image:url(https://yoneyan.dev/images/review/xbox_controller/controller.webp)}.thumb-70cc87f6a35af04e202db28de6cf3052{background-image:url(https://yoneyan.dev/images/free_images/software_1.webp)}.thumb-cd3f7ed7a2fc841be51a072980bccca8{background-image:url(https://yoneyan.dev/images/free_images/software_1.webp)}body{font-family:Lato,YuGothic,hiragino kaku gothic pro,Meiryo,sans-serif}.h-logo{font-family:Lobster,cursive}.l-container{max-width:40rem;margin:0 auto}</style></head><body><amp-analytics type=gtag data-credentials=include><script type=application/json>{"vars":{"gtag_id":"UA-77706989-10}","config":{"UA-77706989-10}":{"groups":"default"}}}}</script></amp-analytics><header class=l-header><h1 class=logo><a href=https://yoneyan.dev/>のんびりと生きたい</a></h1></header><main><div class=l-container><article class=sn><div class="thumb thumb-bbf4d504dc1e4144398b93f8b42b4b72"></div><header class=article-header><h1 class=title>nginxでリバースプロキシとLet's Encryptを導入する</h1><ul class=facts><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=2019-06-04T19:03:13JST>Jun 4, 2019</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i><a href=https://yoneyan.dev/tech/>TECH</a></li></ul><aside class=share><a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&title=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b" title=はてなブックマーク class=ht target=_blank rel="noopener nofollow">B!</a>
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&text=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b&tw_p=tweetbutton" title=Twitterでシェア class=tw target=_blank rel="noopener nofollow"><i class="fab fa-twitter" aria-hidden=true></i></a>
<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&t=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b" title=Facebookでシェア class=fb target=_blank rel="noopener nofollow"><i class="fab fa-facebook" aria-hidden=true></i></a>
<a href="https://getpocket.com/edit?url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&title=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b" title=Pocketに保存 class=pk target=_blank rel="noopener nofollow"><i class="fab fa-get-pocket" aria-hidden=true></i></a>
<a href="https://social-plugins.line.me/lineit/share?url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f" title=LINEでシェア class=ln target=_blank rel="noopener nofollow"><i class="fab fa-line" aria-hidden=true></i></a></aside></header><div class=toc><nav id=TableOfContents><ul><li><a href=#リバースプロキシの設定>リバースプロキシの設定</a><ul><li><a href=#１configを作成する>１．configを作成する</a></li><li><a href=#２動いているか確認する>２．動いているか確認する</a></li></ul></li><li><a href=#lets-encryptの設定>Let&rsquo;s Encryptの設定</a><ul><li><a href=#０lets-encryptで必要なものを入れる>０．Let&rsquo;s Encryptで必要なものを入れる</a></li><li><a href=#１証明書を取得する>１．証明書を取得する</a></li><li><a href=#２設定に追加する>２．設定に追加する</a></li><li><a href=#３証明書を自動更新する>３．証明書を自動更新する</a></li></ul></li><li><a href=#まとめ>まとめ</a></li></ul></nav></div><div class=article-body><p>nginxでLet&rsquo;s Encryptを用いてhttps（SSL/TLS）を有効にする方法をこちらに書いていきます。</p><p>当方のLet&rsquo;s Encryptの記事は備忘録と書きます。他社のサイトさんの方がわかりやすいと思うので、わからない点などがあれば調べていただければ幸いです。</p><p><strong>今回はリバースプロキシを使用します。</strong></p><h2 id=リバースプロキシの設定>リバースプロキシの設定</h2><h3 id=１configを作成する>１．configを作成する</h3><p>/etc/nginx 上にnginxのいろんな設定ファイルがあります。</p><p>特に、nginxのメインとなる主の設定ファイルとなるのが/etc/nginx/nginx.confです。</p><p>ですが、このファイルを直接弄ってしまうとわかりにくいという問題が起きるので今回は/etc/nginx/conf.d/以下のファイルを新たに作成します。</p><p>/etc/nginx/conf.d/[好きな名前].conf</p><pre tabindex=0><code>server{
    server_name    example.net;
    listen 80;

    proxy_set_header    Host    $host;
    proxy_set_header    X-Real-IP    $remote_addr;
    proxy_set_header    X-Forwarded-Host       $host;
    proxy_set_header    X-Forwarded-Server    $host;
    proxy_set_header    X-Forwarded-For    $proxy_add_x_forwarded_for;

    location /test1/ {
        proxy_pass    http://localhost:8080/;
    }

    location /test2/ {
        proxy_pass    http://localhost:3000/;
    }
}
</code></pre><h3 id=２動いているか確認する>２．動いているか確認する</h3><pre tabindex=0><code>systemctl restart nginx
</code></pre><p>nginxを再起動させて、リバースプロキシが働いてくれているか確認します。</p><h2 id=lets-encryptの設定>Let&rsquo;s Encryptの設定</h2><h3 id=０lets-encryptで必要なものを入れる>０．Let&rsquo;s Encryptで必要なものを入れる</h3><pre tabindex=0><code>yum -y install epel-release
yum -y install certbot
</code></pre><p>certbotというものが必要となるので、インストールします。</p><h3 id=１証明書を取得する>１．証明書を取得する</h3><p>certbotを使って取得します。</p><pre tabindex=0><code>certbot certonly --standalone
</code></pre><h3 id=２設定に追加する>２．設定に追加する</h3><p>certbotを実行することで、</p><ul><li>cert.pem</li><li>privkey.pem</li></ul><p>が作られました。</p><p>これらをnginxに反映させるために設定ファイルを追加させます。</p><p>/etc/nginx/conf.d/log.conf</p><pre tabindex=0><code>server{
    server_name    example.net;
    listen 443 ssl;

    ssl on;
    ssl_certificate /etc/letsencrypt/live/example.net/cert.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.net/privkey.pem;

    proxy_set_header    Host    $host;
    proxy_set_header    X-Real-IP    $remote_addr;
    proxy_set_header    X-Forwarded-Host       $host;
    proxy_set_header    X-Forwarded-Server    $host;
    proxy_set_header    X-Forwarded-For    $proxy_add_x_forwarded_for;

    location /test1/ {
        proxy_pass    http://localhost:81/;
    }

    location /test2/ {
        proxy_pass    http://localhost:3000/;
    }
}
</code></pre><h3 id=３証明書を自動更新する>３．証明書を自動更新する</h3><p>Let&rsquo;s Encryptの証明書の場合では、３ヶ月毎に更新しないと失効してしまうのでcronに自動更新できるようにしておきます。</p><pre tabindex=0><code>sudo crontab -e
</code></pre><p>cronの設定ファイルが出てくるので、以下のものを入力します。</p><pre tabindex=0><code>0 0 * * * certbot renew &amp;&amp; systemctl restart nginx
</code></pre><p>今回の設定では毎日深夜０時に
<strong>certbot renew && systemctl restart nginx</strong>
を実行するようになっています。</p><h2 id=まとめ>まとめ</h2><p>これでリバースプロキシを使ったhttps化ができるようになりました。</p></div><footer class=article-footer><aside class=share><a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&title=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b" title=はてなブックマーク class=ht target=_blank rel="noopener nofollow">B!</a>
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&text=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b&tw_p=tweetbutton" title=Twitterでシェア class=tw target=_blank rel="noopener nofollow"><i class="fab fa-twitter" aria-hidden=true></i></a>
<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&t=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b" title=Facebookでシェア class=fb target=_blank rel="noopener nofollow"><i class="fab fa-facebook" aria-hidden=true></i></a>
<a href="https://getpocket.com/edit?url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f&title=nginx%e3%81%a7%e3%83%aa%e3%83%90%e3%83%bc%e3%82%b9%e3%83%97%e3%83%ad%e3%82%ad%e3%82%b7%e3%81%a8Let%27s%20Encrypt%e3%82%92%e5%b0%8e%e5%85%a5%e3%81%99%e3%82%8b" title=Pocketに保存 class=pk target=_blank rel="noopener nofollow"><i class="fab fa-get-pocket" aria-hidden=true></i></a>
<a href="https://social-plugins.line.me/lineit/share?url=https%3a%2f%2fyoneyan.dev%2famp%2ftech%2flinux%2freverse-proxy-and-letsencrypt-with-nginx%2f" title=LINEでシェア class=ln target=_blank rel="noopener nofollow"><i class="fab fa-line" aria-hidden=true></i></a></aside><section class=footer><header><a href=https://yoneyan.dev/tags/>TAGS</a></header><ul class=terms><li><a href=https://yoneyan.dev/tags/nginx/>nginx</a></li></ul></section></footer></article><div class="adj mrow"><div class="mcol c6"><header>Next Article</header><article class=lism><a href=https://yoneyan.dev/amp/tech/linux/error-libvirt-1/><div class="thumb thumb-b3a22ab46469c6b53a9e446f8893da65"></div><div class=inner><div class=title>virt-install時にbr0のエラーが出て進まない</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=31007-07-31T21:58:46JST>Jul 31, 2019</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>TECH</li></ul></div></a></article></div><div class="mcol c6"><header>Previous Article</header><article class=lism><a href=https://yoneyan.dev/amp/tech/linux/linux-disk-capacity-expansion-method/><div class="thumb thumb-0b483f78ca2c76cc512f8e7ab162aa07"></div><div class=inner><div class=title>Linuxのディスク容量拡張の方法</div><ul class="facts sm"><li><i class="fas fa-calendar" aria-hidden=true></i><time datetime=3007-06-03T13:59:36JST>Jun 3, 2019</time></li><li><i class="fas fa-bookmark" aria-hidden=true></i>TECH</li></ul></div></a></article></div></div></div></main><footer class=l-footer><div class=l-container><p><span class=h-logo>&copy; のんびりと生きたい</span></p></div></footer></body></html>